if(function(){var a=function(){this.datastore=null,this.results=[],this.selectedIndex=0,this.target=null,this.dom=null,this.lastValue="";var a=this;this.attach=function(a){"complete"===document.readyState||a.safeload===!1?d.attach(a):c.addListener(window,"load",function(){d.attach(a)})};var d={};d.attach=function(b){for(var e in b)a.options[e]=b[e];if(!b.target)return void console.log("Error: Target not specified");if(a.target=document.getElementById(a.options.target),!a.target)return void console.log("Error: Target ID could not be found");if("undefined"==typeof a.options.display_name&&(a.options.display_name=a.options.key_value),"undefined"!=typeof a.options.url)c.ajaxGetJSON(b.url,d.initialise_data);else{if("undefined"==typeof a.options.data)return void console.log("Error: No datasource provided.");d.initialise_data(b.data)}a.dom=document.createElement("div"),a.dom.className="quickspot-results",a.dom.setAttribute("tabindex","100"),a.dom.style.display="none","undefined"==typeof a.options.results_container?a.target.parentNode.appendChild(a.dom):document.getElementById(a.options.results_container).appendChild(a.dom),c.addListener(a.target,"keydown",d.handleKeyUp),c.addListener(a.target,"keyup",d.handleKeyDown),c.addListener(a.target,"focus",d.handleFocus),c.addListener(a.target,"blur",d.handleBlur),c.addListener(a.dom,"blur",d.handleBlur),c.addListener(a.dom,"blur",d.handleKeyUp),"function"==typeof b.ready&&b.ready(a)},d.findResultsFor=function(b){return""==b?("function"==typeof a.options.no_search_handler&&a.options.no_search_handler(a.dom,a),a.results=[],void(a.dom.style.display="none")):(b=b.toLowerCase(),a.lastValue==b?(a.dom.style.display="block",void c.triggerEvent(a.target,"quickspot:result")):(c.triggerEvent(a.target,"quickspot:start"),a.lastValue=b,this.selectedIndex=0,a.results=a.datastore.search(b).get(),d.render_results(a.results),c.triggerEvent(a.target,"quickspot:end"),void c.triggerEvent(a.target,"quickspot:result")))},d.handleFocus=function(b){d.findResultsFor(a.target.value)},d.handleKeyDown=function(b){d.findResultsFor(a.target.value)},d.handleKeyUp=function(b){var e=b.keyCode;13==e&&d.handleSelection(a.results[a.selectedIndex]),38==e&&(d.selectIndex(a.selectedIndex-1),d.scrollResults("up"),c.triggerEvent(a.target,"quickspot:select")),40==e&&(d.selectIndex(a.selectedIndex+1),d.scrollResults("down"),c.triggerEvent(a.target,"quickspot:select")),(13==e||38==e||40==e)&&(b.preventDefault?b.preventDefault():b.returnValue=!1)},d.handleBlur=function(b){("undefined"==typeof a.options.hide_on_blur||a.options.hide_on_blur!==!1)&&setTimeout(function(){a.dom!=document.activeElement&&a.target!=document.activeElement&&(a.dom.style.display="none")},150)},d.selectIndex=function(b){c.removeClass(a.dom.children[a.selectedIndex],"selected"),b>=a.results.length?a.selectedIndex=a.results.length-1:0>b?a.selectedIndex=0:a.selectedIndex=b,c.addClass(a.dom.children[a.selectedIndex],"selected")},d.scrollResults=function(b){results_height=a.dom.clientHeight;var c=a.dom.childNodes[a.selectedIndex],d=c.offsetHeight,e=c.offsetTop;"down"==b&&e+d-a.dom.scrollTop>results_height&&(a.dom.scrollTop=e+d-results_height),"up"==b&&e<a.dom.scrollTop&&(a.dom.scrollTop=e)},d.render_results=function(b){if(0===b.length){var e=a.options.no_results(a,a.lastValue);return e!==!1?(a.dom.innerHTML=e,"undefined"!=typeof a.dom.childNodes[0]&&c.addListener(a.dom.childNodes[0],"click",function(a){d.handleSelection()})):a.dom.style.display="none",void c.triggerEvent(a.target,"quickspot:noresults")}var f,g=document.createDocumentFragment();b.forEach(function(b,e){f=document.createElement("a"),"undefined"!=typeof a.options.display_handler?f.innerHTML=a.options.display_handler(b,a):f.innerHTML=b[a.options.display_name],f.className="quickspot-result quickspot-result-"+e,c.addListener(f,"click",function(a){d.handleSelection(b)}),c.addListener(f,"mouseover",function(a){d.selectIndex(e)}),g.appendChild(f)}),c.triggerEvent(a.target,"quickspot:resultsfound"),a.dom.innerHTML="",a.dom.style.display="block",a.dom.appendChild(g),d.selectIndex(this.selectedIndex)},d.handleSelection=function(b){return"undefined"==typeof b?a.options.no_results_click(a.lastValue,a):void("undefined"!=typeof a.options.click_handler?a.options.click_handler(b):"undefined"!=typeof b.url?window.location=url:(a.target.value=b[a.options.display_name],a.dom.style.display="none"))},d.no_results=function(a,b){return"<a class='quickspot-result selected'>No results...</a>"},d.initialise_data=function(c){a.datastore=b.create(c,a.options),"undefined"!=typeof a.options.loaded&&a.options.loaded(a.datastore)},this.options={key_value:"name",no_results:d.no_results,no_results_click:function(a,b){}}},b=function(a,b){this.data=[],this.data_filtered=[],this.results=[];var d=this,e={};e.create=function(a,b){for(var c in b)d.options[c]=b[c];if(d.options.key_value||(d.options.key_value="name"),"object"==typeof a){var f=[];for(var c in a)a.hasOwnProperty(c)&&f.push(a[c]);a=f}for(var g="undefined"!=typeof d.options.search_on?d.options.search_on:!1,c=0;c<a.length;c++)a[c]=e.pre_process(a[c],g);d.data_filtered=d.data=a},this.find=function(a,b){return a=d.options.string_filter(a.toLowerCase()),this.results=e.find(a,this.data_filtered,b),this},this.sort_results_by=function(a){return a=d.options.string_filter(a.toLowerCase()),this.results=e.sort_by_match(this.results,a),this},this.search=function(a){return this.find(a).sort_results_by(a),this},this.filter=function(a,b){return"function"==typeof a?this.results=this.data_filtered=e.findByFunction(a,this.data_filtered):(a=d.options.string_filter(a.toLowerCase()),this.results=this.data_filtered=e.find(a,this.data_filtered,b)),this},this.clear_filters=function(){return this.data_filtered=this.data,this},this.add=function(a){if("array"==typeof a){for(var b=0;b<a.length;b++)this.add(a[b]);return this}var c="undefined"!=typeof d.options.search_on?d.options.search_on:!1;return this.data.push(e.pre_process(a,c)),this.data_filtered=this.data,this},this.get=function(){return this.results},e.pre_process=function(a,b){var c="";if(b)for(var e=0;e<b.length;e++)c+=" "+a[b[e]];else for(var e in a)c+=" "+a[e];return a.__searchvalues=d.options.string_filter(c.toLowerCase()),a.__keyvalue=d.options.string_filter(a[d.options.key_value].toLowerCase()),a},e.find=function(a,b,c){var d,e=0,f=[];for("undefined"==typeof c&&(c="__searchvalues"),e=0;e<b.length;e++)d=b[e],-1!==d[c].indexOf(a)&&f.push(d);return f},e.findByFunction=function(a,b){var c,d=0,e=[];for(d=0;d<b.length;d++)c=b[d],a(c)&&e.push(c);return e},e.sort_by_match=function(a,b){for(var c="undefined"==typeof d.options.gen_score?e.calculate_match_score:d.options.gen_score,f=0;f<a.length;f++)a[f].__score=c(a[f],b),a[f].__len_diff=Math.abs(b.length-a[f].__keyvalue.length);return a.sort(function(a,b){return a.__score==b.__score?a.__len_diff==b.__len_diff?0:a.__len_diff>b.__len_diff?1:-1:a.__score<b.__score?1:-1}),a},e.calculate_match_score=function(a,b){var e,f=0;return e=a.__keyvalue.indexOf(b),!d.options.disable_occurrence_weighting&&b.length>2&&(f+=c.occurrences(a.__searchvalues,b)),f+=-1!==a.__searchvalues.indexOf(" "+b)?5:0,f+=-1!==e?10:0,f+=0===e?25:0,f+=0===e&&a.__keyvalue.length===b.length?10:0},e.simplfy_strings=function(a){return a=a.replace(/(\"|\'|\,|\.|\)|\(|\-)/g,""),a=a.replace(/\&/g,"and")},this.options={string_filter:e.simplfy_strings,disable_occurrence_weighting:!1},e.create(a,b)};b.create=function(a,c){return new b(a,c)};var c={};c.ajaxGetJSON=function(a,b){try{var c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")}catch(d){}c.onreadystatechange=function(){4==c.readyState&&200==c.status&&b(JSON.parse(c.responseText))},c.open("GET",a,!0),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(null)},c.addListener=function(a,b,c){window.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},c.triggerEvent=function(a,b){if(document.createEvent){var c=document.createEvent("HTMLEvents");c.initEvent(b,!0,!0),a.dispatchEvent(c)}},c.addClass=function(a,b){null!=a&&(c.hasClass(a,b)||(a.className=a.className+" "+b))},c.removeClass=function(a,b){null!=a&&(a.className=a.className.replace(new RegExp("(^|\\s)"+b+"(\\s|$)"),""))},c.hasClass=function(a,b){return null!=a?null!=a.className.match(new RegExp("(^|\\s)"+b+"(\\s|$)")):void 0},c.occurrences=function(a,b){if(a+="",b+="",b.length<=0)return a.length+1;for(var c=0,d=0,e=b.length;;){if(d=a.indexOf(b,d),!(d>=0))break;c++,d+=e}return c},window.quickspot={},window.quickspot.attach=function(b){var c=new a;return c.attach(b),c},window.quickspot.datastore=function(a){if("undefined"!=typeof a.url){var d={};return c.ajaxGetJSON(a.url,function(c){d.store=b.create(c,a),"undefined"!=typeof a.loaded&&a.loaded(d.store)}),d}return{store:b.create(data,a)}}}.call({}),"forEach"in Array.prototype||(Array.prototype.forEach=function(a,b){for(var c=0,d=this.length;d>c;c++)c in this&&a.call(b,this[c],c,this)}),"undefined"==typeof JSON){var json2=document.createElement("script");json2.src="//ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js",document.getElementsByTagName("head")[0].appendChild(json2)}"undefined"==typeof console&&(window.console={log:function(a){}});